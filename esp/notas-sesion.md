# El mercado de las vulnerabilidades informáticas,

## la desregulación de la vigilancia digital



### Objetivos

Somos tes (she/her) y mini (he/him). La sesión propone presentar una investigación en curso que tiene por objetivo el esbozar un ecosistema de los diferentes actores involucrados en la compra y venta de vulnerabilidades y exploits. Sabemos que hay mucho material (muy relevante) que se ocupa de analizar a las agencias gubernamentales y a los actores involucrados en la vigilancia estatal, como una parte clave de este ecosistema, pero nuestro objetivo es ampliar la escena con otros actores involucrados, como ser las plataformas de bug bounties, empresas intermediarias con otros modelos de negocios, etc. 
La propuesta para el Internet Freedom Festival es dar la sesión enteramente en español, pero verán que en la práctica terminamos usando muchos términos en inglés que definiremos en todos los casos para que se comprendan. La sesión apunta a aquellas personas con o sin conocimientos técnicos, por lo que en un primer momento introduciremos todos los conceptos "técnicos" que a lo largo de esta hora vamos a utilizar.

###  Estructura de la sesión  
1) Glosario  
2) Actores  
3) Análisis del gráfico: qué se comercializa, cómo, por quién.  
4) Regulación
5) Cierre + debate

### Glosario
####  ¿Qué es una vulnerabilidad?
Es un falla o limitación en el diseño, procedimiento o implementación de un sistema.
**Una vulnerabilidad “explotable”**: falla que representa un riesgo de seguridad.

####  ¿Qué es un “exploit”?
Una porción de código, una serie de caracteres o secuencia de comandos que permiten aprovecharse de una vulnerabilidad para lograr un funcionamiento no esperado de un programa o ganar acceso a un sistema.

####  ¿Qué es un ataque zero day?
Ante una vulnerabilidad que todavía no fue parcheada o mitigada. También se lo considera cuando no es pública información de la vulnerabilidad ni en general ni el vendor: por lo que no existe parche o solución.
Un ataque de día es un exploit que la aprovecha de esa vulnerabilidad.

####  ¿Qué es Vendor?
Lxs encargados de desarrollar y mantener el código del software vulnerable. Son lxs que hacen los parches.
Es importante considerar que en el caso de software privativo el vendor será una empresa privada, pero en el caso de desarrollos software libre el vendor es aquella comunidad encargada de desarrollar y mantener el software.

####  ¿Qué es Parche?
Los cambios que se le hacen a un programa para corregir los errores que lo vuelven vulnerable.

####  ¿Qué es Disclosure?
Revelación de información acerca de una vulnerabilidad con o sin info de cómo explotarla.
Proceso por el cual info de una vulnerabilidad se comparte con 3eros.

* **Full disclosure:** hacer pública una vulnerabilidad antes de que el vendor tenga un parche. Con/Sin una prueba de concepto.  (**POC:** por sus siglas en inglés es un código que funciona como Prueba de Concepto: es un resumen descriptivo y funcional de cómo se explotaría. Explica en términos técnicos como aprovecharse de la vulnerabilidad).

* **Disclosure Coordinado:** lxs vendors tienen el control de la información sobre la vulnerabilidad. Se les reporta únicamente a ellos el bug y de ellxs dependerá la publicación de información en relación a la vulnerabilidad.
	- hay dos normas iso para mejores practicas ISO 29147 and ISO 30111
	- el VEP (Vulnerabilities Equities Process) es el protocolo con el que Estados Unidos evalua si hacer Disclosure de una vulnerabilidad zero day que ellos manejan.
	- Distintas organizaciones tienen sus recomendaciones (ej: CERT, Bugcrowd) sobre el disclosure recomendado. 
Ha existido un debate en relación al término de *disclosure coordinado* vs *disclosure responsable*. Ambos términos significan lo mismo, pero en su momento Microsoft acuño el término de *disclosure responsable* [1], denominando implícitamente a cualquier otro mecanismo para el manejo de fallas que no sea coordinado como **irresponsable**.

####  ¿Cómo se clasifican las vulnerabilidades?

El siguiente es un esbozo no exhaustivo, útil a los fines de la exposición.

- Clasificación por el tipo de exploit:
	- **DoS** (ataque de denegación de servicio)
	- **Escalar privilegios**
	- **Ejecución remota de código**

- Clasificación según desde donde se explota:
	- **Desde internet**: *ej. Atacar un servicio web publico*
	- **Desde la misma red**: *ej. ataque sobre una lan o vpn*
	- **Local desde la misma maquina**: *ej. escalar privilegios*                       
- Clasificación según complejidad para explotarla:
	- **Necesita autenticacion?** *Ej. ataque con credenciales/token.*
	- **Necesita phishing?** *Ej. click a un enlace malicioso.*
	- **Necesita acceso físico?** *Ej. ataque por WIFI o USB.*

####  Identificadores:
Hay varios identificadores de vulnerabilidades, los mas comunes
- Common Vulnerabilities and Exposures (CVE)
- National Vulnerabilitiy Database (NVD)

###  Mercado 
#### ¿Qué mercados hay?
Optamos por **no** usar el binomio **mercado negro** vs **mercado blanco/legal**, ya que plantea un sentido ideológico de legalidad e ilegalidad sin considerar a los actores que habitan cada mercado. Obviando por ejemplo casos donde actores compran y venden vulnerabilidades en el mercado supuestamente legal pero sus prácticas son cuestionables en muchos sentidos. 
Por eso adoptamos nociones como mercados públicos, donde la información de compra y venta se encuentra publicitada abiertamente; y por otro lado los mercados anónimos e informales donde la compra/venta se produce de manera anónima y por canales informales no institucionales. En paralelo identificamos un mercado entre privados donde los intercambios que se producen no son públicos, aunque podrán ser o no anónimos.

Por lo tanto los tipos de mercado que identificamos son:

* Mercados anonimos/informales. 
* Mercados privados
* Mercados publicos con y sin disclosure

Por último, creemos que este escenario se complejiza porque existen intercambios que no son por dinero sino por un capital intangible como puede ser la *reputación* (o sea ante un disclosure el investigador aparece en un listado denominado *hall of fame* que no redunda en capital monetario sino en un capital profesional de reputación, obviamente bien considerado en el mercado laboral de investigación en seguridad).

#### ¿Qué se comercializa?
* Vulnerabilidades
* Exploits
* BotNets
* Exploitkits y Malware varios
* Accesos a dispositivos/redes

#### ¿Quién lo comercializa?
* **Independientes/Anonimos**
* **APTs**
* **Corporaciones**
	- **Organizaciones privadas**: como empresas de venta de software de vigilancia. ejemplo Hacking Team.
	- **Agencias gubernamentales**: que desarrollan sus propios exploits para vulerabilidades existententes. O encuentran sus propios zero days. O compran a privados algunos de sus exploits/zero days.

* **Vendors**: 
En algunos casos cuentan con sus propios programa de Vulnerability disclosure. Es un canal de comunicación directa para reportarle a aquellxs que desarrollan y mantienen el software alguna vulnerabilidad. Es importante tener en cuenta que los vendors puede ser una comunidad de software libre y no sólamente una empresa desarrolladora de software privativo.

* **Intermediarios**: 
	- **Brokers pagos**:
Los denominamos brokers pagos (for profit) que compran a investigadores independientes (zero days y no zero days), y venden a clientes a cambio de una suscripción anual junto a mitigaciones o recomendaciones de seguridad. En muchos casos indican que sus clientes son corporaciones que pueden hacer solo un uso "defensivo" de la información y/o gobiernos. No en todos los casos realizan un disclosure de la información de la vulnerabilidad o exploit. Por ejemplo Zerodium, con una suscripción anual que sale 500.000 dólares al año, no realiza un disclosure al vendor. Y en cambio otros intermediarios como Tipping point sí lo realizan.
Los vendors y usuaries estan forzadxs a subscribirse para tener informacion importante en relación a la falla de seguridad. En muchos casos para obtener información temprana de la misma o parches temporarios -caso Tipping point y ZDI- y en otros casos para conocer directamente cualquier información vinculada a ella -caso Zerodium.

	- **Plataformas de Bug Bounty**:
	Los bug bounties son programas de recompensa de bugs. Un tercero media entre la investigadora y el vendor, funcionando como intermediario en el intercambio. Y también en general se ocupan de analizar la veracidad, pertinencia y factibilidad de la vulnerabilidad reportada, por lo que su modelo de negocios en tanto intermediario es quedándose con un porcentaje de las regalías. Dos ejemplos son: Bugcrowd y HackerOne.
Desde el punto de vista de la seguridad de los sistemas es interesante que la mayoria de las vulnerabilidades encontradas en las plataformas son de poco impacto como xss o xxe. 

## Análisis del gráfico:

![mapa-de-actores-esp](mapa-de-actores.png)

En primer lugar, se produce la Detección de Vulnerabilidades por parte de Desarrolladorxs independientes y laboratorios de investigación de corporaciones o agencias gubernamentales. A partir del análisis de esa falla de seguridad tiene lugar el desarrollo de un exploit que permitirá aprovecharse de ella. En este punto hay dos opciones: comercializarla o no. 

Si se opta por no comercializarla las opciones también son dos: se podrá o no hacer un disclosure de esa información.

Si no se opta por un disclosure se produce lo que se denomina como un "uso in the wild", es decir se utiliza esa información de manera privada, sin publicar ningun detalle de la misma ni a los vendors ni a la opinión pública. este camino lo seguirán agencias gubernamentales, hackers independientes, APTs y actores encargados de realizar espionaje corporativo. En muchos casos a partir de este uso "in the wild", el exploit y la vulnerabilidad es detectada por parte de actores encargados de relevarlas. Como por ejemplo los CERTs (equipos de respuesta a incidentes a nivel nacional o corporativo) y laboratorios independientes de empresas, ongs y universidades. 

Si en cambio el camino elegido es no comercializar la vulnerabilidad o exploit pero sí hacer un disclosure de esa información lo que sucede es que se la comparte con los vendors directamente o sino se realiza un full disclosure, haciendo directamente pública la información de la vulnerabilidad (acompañada o no de una prueba de concepto de cómo explotarla). En muchos casos se producen full disclosures luego de informar a los vendors y que ellxs consideren que no es prioridad de negocio enparchar la falla; a partir de allí se busca presionar para la creación de un parche, haciendo pública la información.

Por último si el camino elegido es la comercialización del exploit, ingresamos en los mercados de compra y venta de exploits. En este caso hay varias opciones. En primer lugar comercializarlo en el mercado privado (donde los intercambios suceden entre privados por contacto individual o a través de brokers privados) o en el mercado anónimo como pueden ser foros o canales IRC donde en general se puede observar la venta de Exploit Kits (no así la venta más costosa de zero days). En ambos casos no se hace un disclosure de la información del exploit o vulnerabilidad y los clientes de estos mercados serán privados o agencias gubernamentales.

En segundo lugar la compra/venta puede tener lugar en lo que denominamos como Mercado oficial y/o público, aquí según con qué actor se comercialice la información tendremos o no un disclosure de la misma. 

Por un lado si se puede optar por la venta a empresas de software de vigilancia (como Hacking Team, Gamma international o NSO) o a alguna de las empresas que funcionan como intermediarias de las mismas. Por otro lado se puede optar por venderselas a brokers privados como Zerodium que no harán un disclosure. Y si en cambio se opta por comercializarlos con empresas como Tipping point (con su programa Zero Day initiative) o iDefense, éstas ofreceran un parche temporario exclusivo de sus propios clientes (sumado a recomendaciones de seguridad y mitigaciones) e iniciaran un proceso de disclosure coordinado con el vendor.

También bajo la premisa de comercializar el exploit/vulnerabilidad en el mercado público oficial y asegurarse de que suceda un disclosure coordinado es posible realizar el intercambio a través de programas de vulnerability disclosure de los propios vendors o de plataformas de bug bounties (como hackerone o bugcrowd). 

Una vez que los vendors son informados de la vulnerabilidad y de cómo se está explotando comienzan el desarrollo de un parche de seguridad. Hasta ese momento, durante todos los escenarios planteados lxs usuarios se mantuvieron vulnerables. Recién cuando ese parche es público y lxs usuarixs optan por actualizar sus sistemas o programas vulnerables, recién en ese momento es que lxs usuarios dejan de ser vulnerables. 

#### Historización del mapa de actores

El mapa es posible verlo como una foto del ecosistema de actores de la compra y venta de vulnerabilidades y exploits. Pero también es interesante el punto de vista temporal qué muestra cómo han aparecido estos diferentes actores, en qué época histórica y bajo qué motivaciones. De manera sucinta y en forma expositiva se pueden considerar los siguientes momentos:

- **Década del '90: el movimiento Full Disclosure**. 
Un primer momento en el que el descubrimiento de fallas y publicación de estrategias de ataques se realizaba bajo un ánimo de singularidad, pensamiento lateral y creatividad vinculada a la ética y el hacer hacker. El objetivo se barajaba como elevar la vara de seguridad de los sistemas y no se monetizaba esa información sino que se la hacía pública a través de listas de correo electrónico como Bugtraq, con el fin de obtener reconocimiento entre pares.

- **Fines de los '90 y principios del 2000: el fenomenos de la compra de vulnerabilidades**
Se produce la compra de vulnerabilidades como un fenómeno nuevo. Este periodo es monopolizado por dos actores quienes crean un modelo de negocios alrededor de la compra y venta de vulns y exploits. 
**iDefense**: se crea en el 2002 y se ocupa de comprar vulnerabilidades a investigadores independientes y a su vez tiene su propio laboratorio de investigación. Bajo el modelo de negocio de suscripciones cuenta con sus propios clientes a quienes les informa de manera exclusiva recomendaciones de seguridad y mitigaciones frente a las vulnerabilidades adquiridas. 
**Tipping point y su programa Zero Day Initiative**: se crea en el 2005 y tiene un modelo de negocios similar a iDefense. Pero Tipping point comercializa un sistema de detección y prevención de intrusiones (programa que monitorea el tráfico de red para controlar accesos maliciosos), por lo que sus clientes de manera exclusiva obtienen una protección actualizada a partir de parches temporarios que los protege frente a las amenazas adquiridas por la empresa bajo el programa ZDI.

- **Fines de los 2000: Programas de vendors de bug bounties**
El precursor de estos programas es Mozilla quien ofrece dinero a cambio de bugs o fallas de seguridad. Surge en ciernes una tendencia al crowdsourcing de la investigación en seguridad. 

- **Década de 2010: Plataformas Bug Bounties**
Aparecen intermediarios entre los vendors y lxs investigadoxs de seguridad. Su modelo de negocios es cobrar una prima de la recompensa por los bugs, ofreciendo una revisión de los reportes de las fallas y asegurando su pertenencia a los vendors, además de ofrecer -a través de estrategias de marketing e incentivos- una "multitud" de investigadores en seguridad dispuestos a analizar el software en cuestión. En el 2011 nace BugCrowd, en el 2012 Hackerone, entre otros. 
Se produce la maduración del crowdsourcing en la investigación en seguridad. 

##  Regulacion 

### Convenio Budapest
* Convenio firmado en 2001.

**Problemas**:
* Criminaliza la investigacion y desarrollo de herramientas de seguridad.  
* Firmada por los siguientes **paises en America:** Argentina, Canada, Chile, Colombia, Costa Rica, Panama, Paraguay, Peru, Republica Dominicana, Estados Unidos

###  Acuerdo de Wassenaar
* Acuerdo multilateral de control de exportación de armas y tecnologias duales

**Problemas**:
* En el 2013 se agrego sistemas de vigilancia e intrusion de forma tan amplia que incluia a la gran mayoria de tecnologias usadas en investigación y desarrollo en seguridad informática.
* En el 2015 se hicieron modificaciones para mejorar los cambios del 2013, Ahora no entran tecnologias para vulnerability disclosure  o cyber incident response. Esto sigue siendo limitado hoy en día.

##  A modo de cierre  
### Ventana de tiempo vulnerable
Durante todo el proceso de intercambio analizado, la mayoría del tiempo la usuarix es vulnerable. La pregunta es cómo poner a disposición información de vulnerabilidades al público para que estén seguros más rápido. Es posible que a través de un disclosure coordinado el vendor considere que no es prioritario a nivel negocios dar una solución a la falla y el usuarix permanece bajo desconocimiento de la vulnerabilidad de sus sistemas. Al mismo tiempo si se opta por hacer pública la vulnerabilidad cuánta información es necesario proveer, por un lado para ejercer presión a los vendors para que la emparche y por otro lado para dar herramientas a los administradores de sistemas y usuarixs para poder emparchar a su vez esa falla.

De todas maneras es importante que las organizaciones cuenten con una plataforma de bug bounties y tener un mecanismo de disclosure para que se les pueda reportar vulnerabilidades aunque no sea con un intercambio monetario (dificil en organizaciones sin fines de lucro) sino bajo la modalidad de "wall of honour". Es clave aceitar los mecanismos de emparchado y darle la importancia que se merece a parches, no sólo del lado de lxs desarrolladorxs sino también a nivel usuarix mantener actualizado los sistemas y programas en uso.  

### Proceso de comoditización de las vulnerabilidades/exploits
Hemos visto que las vulnerabilidades/exploits se han vuelto unidades de intercambio con un precio asignado, con una demanda y un comprador. Bajo la presencia de mercados que permiten su compra-venta como un bien más a cambio de dinero. Y en este contexto existe un uso privado de información restringida sobre vulnerabilidades, con objetivos políticos y económicos. 
Se cuenta con muy poca información (en general a partir de filtraciónes) de cómo se manejan actores como Hacking Team y Gamma International. Se necesita mas informacion publica en relación a su accionar.  

### Investigación en seguridad
Es importante la seguridad ofensiva / investigación en seguridad / analisis de vulnerabilidades para la detección de vulnerabilidades de alto impacto, para elevar la seguridad de todxs. Y que esas actividades no sean criminalizadas sin distinción. 
Si va a haber regulación consideramos que es importante que vaya por una línea que no criminalice la investigación en seguridad. Actualmente el análisis de vulnerabilidades e investigaciones en seguridad ofensiva son cuestiones relevantes que permiten avanzar el estado de seguridad de los sistemas.

Y resta mencionar que el proceso de crowdsourcing ha redundado en el avance de la flexibilización laboral en la investigación en seguridad. Se ha puesto el énfasis en externalizar y tercerizar los analisis y auditorias de seguridad a través de plataformas intermediarias como Hackerone, en detrimento de la constitución de equipos internos de seguridad dentro de las organizaciones. Creemos que ambas estrategias son complementarias y deberían priorizarse en simultáneo para lograr realmente la detección de fallas de los sistemas.

## Notas

[1]:   Término adoptado por Scott Culp, Microsoft Security Manager, en: "It's Time to End Information Anarchy". Technet Security. Microsoft TechNet. November 9, 2001.

## Bibliografía

M. Marquis-Boire *et al.*, *For their eyes only: the commercialization of digital spying*. Toronto, Ont.: Citizen Lab, 2013.

D. McKinney, *Vulnerability Bazaar*. IEEE security & privacy., vol. 5, n.º 6, pp. 69-73, 2007.