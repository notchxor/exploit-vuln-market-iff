# The market of software vulnerabilities,

## the deregulation of digital surveillance



### Objectives

We are tes (she/her) and mini (he/him). The session proposes to present an ongoing research aimed at outlining an ecosystem of the different actors involved in the selling and consuming of vulnerabilities and exploits. We know that there is a lot of (important) material that analyzes the role of government agencies and other actors involved in state surveillance as a key part of this ecosystem, but our goal is to expand the scene reviewing in detail other actors involved, such as bug bounties platforms, intermediary companies with other business models, etc.
The proposal of our session for the Internet Freedom Festival is to give it entirely in Spanish, although in practice we end up using many terms in English that we will define in all cases so we all be on the same page. The session is aimed at people with or without technical knowledge, so at first we will introduce all the "technical" concepts that we are going to use throughout this hour.

### Session structure  

1) Glossary  
2) Actors  
3) Analysis of the graph: what is commercialized, how, by whom.  
4) Regulation
5) Closure + debate

### Glossary

#### What's a vulnerability?

A vulnerability is a failure or limitation in the design, procedure, or implementation of a system.
**An "exploitable" vulnerability**: is a failure that represents a security risk.

#### What is an exploit?

A portion of code, a series of characters, or a sequence of commands that allows a vulnerability to be exploited to achieve unexpected program performance or gain access to a system.

#### What is a zero day attack?

A vulnerability that has not yet been patched or mitigated is considered a zero day vulnerability. It is also considered so when the vulnerability information is not public, neither in general nor to the vendor, so there is no patch or solution for it. A zero day attack is an exploit that takes advantage of that vulnerability.

#### What is Vendor?

The people in charge of developing and maintaining the vulnerable software. They are the one that make the patches.
It is important to consider that in the case of proprietary software the vendor will be a private company, but in the case of free software (software libre) development the vendor is the community in charge of developing and maintaining the software.

#### What is Patch?

The changes that are made to a program to correct the errors that make it vulnerable.

#### What is Disclosure?

The announcement or report of information about a vulnerability with or without information on how to exploit it.
Process by which information about a vulnerability is shared to third parties.

- **Full disclosure:** making public a vulnerability before the vendor has a patch. With/without a Proof of Concept. (**POC:** a code that functions as Proof of Concept is a code extract descriptive and functional that gives a hint (more or less exhaustive) on how the vulnerability can be exploited. It explains in technical terms how to take advantage of a vulnerability).
- **Coordinated Disclosure: ** happens when only the vendors have control of the information about the vulnerability. The bug is only reported to them and it's up to them the publication of information about the vulnerability.
  - There are two ISO standards for best practices ISO 29147 and ISO 30111
  - The VEP (Vulnerabilities Equities Process) is the protocol with which the United States evaluates whether to make Disclosure of a zero day vulnerbaility that they handle.
  - Different organizations have their recommendations (e.g., CERT, Bugcrowd) about the kind of disclosure expected.
    There has been a debate regarding the term *coordinated disclosure* vs *responsible disclosure*. Both terms mean the same thing, but at the time Microsoft coined the term *responsible disclosure* [1], implicitly naming as **irresponsible** any other disclosure mechanism that is not coordinated.

#### How are vulnerabilities classified?

The following is a non-exhaustive sketch, useful for this session purposes.

- Classification by exploit type:
  - **DoS** (denial of service attack)
  - **Privilege escalation**
  - **Remote Code Execution**

- Classification according to where it is exploited from:
	- **From the Internet**: *e.g. attacking a public web service*.
	- **From the same network**: *e.g. attack on a lan or vpn*.
	- **Local from the same machine**:  *e.g. privileges escalation*.                    

- Classification according to complexity to exploit it:
	- **Is needed authentication? ** *e.g. attack with credentials/token.*
	- **Is needed  phishing? ** *e.g. click on a malicious link.*
	- **Is needed  physical access?** *e.g. attack by WIFI or USB.*

#### Identifiers of vulnerabilities:

There are several vulnerability identifiers, the most common of which are

- Common Vulnerabilities and Exposures (CVE)
- National Vulnerabilitiy Database (NVD)

### Market 

#### What markets are there?

We choose **not** to use the binomial **black market** vs **white/legal market**, since it poses an ideological sense of legality and illegality without considering the actors that inhabit each market. Using those terms don't contemplates cases where actors buy and sell vulnerabilities in a supposedly legal market but -nevertheless- their practices are questionable in many ways. 
That is why we adopt notions such as public markets, where buying and selling information is openly advertised; and on the other hand, anonymous and informal markets where buying/selling takes place anonymously and through non-institutional informal channels. At the same time, we identify a market between private individuals where the exchanges that take place are not public, although they may or may not be anonymous.

Therefore the types of market we identify are:

- Anonymous/informal markets. 
- Private markets
- Public markets with and without disclosure

Finally, we believe that this scenario becomes more complex because there are exchanges that are not for money but for intangible capital such as *reputation* (i.e. after a disclosure the researcher appears in a list called *hall of fame* that does not result in monetary reward directly but it involves a reputation acknowledgement useful in the professional development of a security researcher).

#### What is commercialized?

- Vulnerabilities
- Exploits
- BotNets
- ExploitKits and Malware
- Device/network accesses

#### Who sells it?

- **Independent/Anonymous**
- **APTs**
- **Corporations**
  - **Private organizations**: as companies that sells surveillance software, e.g. Hacking Team.
  - **Government agencies**: that develop their own exploits for existing vulnerabilities. Or they find their own zero days. Or they buy some of their exploits/zero days privately.
- **Vendors:** 
  Some of them have their own Vulnerability disclosure program, that works as a direct communication channel to report a vulnerability to those who develop and maintain the software. Is important to keep in mind that vendors can be a free software (software libre) community and not just a proprietary software corporation.
- **Intermediaries: **
  - **Brokers for profit**:
    These brokers for profit buy from independent researchers zero days and not zero days, and sell that information to their own customers (in exchange of an annual subscription) along with mitigations or security recommendations for the remediation of the bug. In many cases they indicate that their clients are corporations that can make only a "defensive" use of information and/or governments. Not in all the cases this brokers make a disclosure of the information of the vulnerability or exploit to the vendors. For example, Zerodium, with an annual subscription of $500,000 per year, does not disclose to the vendor. On the other hand, other intermediaries such as Tipping point do so.
    In this business model, vendors and users are forced to subscribe to have important information regarding the security of their systems, in many cases just to obtain early information about it or temporary patches -as for Tipping point and ZDI- and in other cases to know at least any information related to it -as for Zerodium.
  - **Bug Bounty Platforms**:
    Bug bounties are bug reward programs. A third party mediates between the researcher and the vendor, acting as an intermediary in the exchange. And also, in general, they are in charge of analyzing the veracity, pertinence and feasibility of the reported vulnerability, so their business model as an intermediary is to keep a percentage of the royalties. Two examples are: Bugcrowd and HackerOne.
    From the point of view of system security, it is interesting to note that most of the vulnerabilities found on platforms have little impact, such as xss or xxe. 

## Analysis of the graph:

![mapa-de-actores-eng](mapa-de-actores-eng.png)

First of all, the Vulnerability Detection takes place thanks to independent researchers and research laboratories of corporations or government agencies. After the study of a security flaw, takes place the development of an exploit that will allow to take advantage of it. At this point there are two possible paths: to commercialize this information regarding the vulnerability and exploit or not. 

If the path chosen is not to commercialize it, there are also two options: a disclosure of this information can either be done or not.

If a disclosure path is not chosen, happens what is called a "use in the wild", that is to say, this information is used privately, without publishing any details of it neither to vendors nor to public opinion. This path will be followed by government agencies, independent hackers, APTs and actors in charge of corporate espionage. In many cases from its repetitive use "in the wild", the exploit and vulnerability is detected by actors in charge of this chore. For example, CERTs (Computer Emergency Response Team from a state or a corporation), independent laboratories of companies, NGOs and universities. 

If, on the other hand, the chosen path is not to commercialize the vulnerability or exploit but to make a disclosure of that information, what happens is that it is shared with the vendors directly. Or other possibility is to make a full disclosure, making public the vulnerability information directly (accompanied or not by a proof of concept of how to exploit it). In many cases, full disclosures are produced after informing vendors and after they consider that it is not a business priority to patch the fault; on this scenario making this information public puts pressure on the vendors for the creation of a patch.

Finally, if the chosen path is the commercialization of the exploit, we enter in the field of the buying and selling markets of vulnerabilities and exploits. In this case there are several paths. In the first place, is possible to commercialize this information in the private market (where the exchanges happen between private parties by individual contact or through private brokers) or in the anonymous market such as forums or IRC channels where in general the sale of Exploit Kits can be observed (not so the most expensive sale of zero days). In both cases there is no disclosure of the exploit or vulnerability information and the clients of these markets will be private or government agencies.

Secondly, the purchase/sale can take place in what we call an official and/or public market, here depending the buyer involved we may or may not have a disclosure. 

On the one hand, it is possible to opt for the sale to companies that sell surveillance software (such as Hacking Team, Gamma international or NSO) or to some of the companies that function as intermediaries those ones. Furthermore one can choose to sell them to private brokers such as Zerodium who will not make a disclosure as they say in their terms and conditions. Or sell it to other companies such as Tipping point (with its Zero Day initiative) or iDefense, that will offer a temporary patch exclusive to their own clients (with security recommendations and mitigations) and will initiate a disclosure process coordinated with the vendor.

Also under the premise of commercializing the exploit/vulnerability in the official public market and making sure that a coordinated disclosure happens, it is possible to carry out the exchange through vendors' own vulnerability disclosure programs or bug bounties platforms (such as hackerone or bugcrowd). 

Once vendors are informed of the vulnerability and how it is being exploited, they begin the development of a security patch. During this process the users remained vulnerable, in every of the scenarios considered. Only when this patch is public and users update their vulnerable systems or programs, the users cease to be vulnerable. 

#### A historical perspective on the map of actors

The map can be seen as a photo of the ecosystem of actors buying and selling vulnerabilities and exploits. Although it would be interesting to go through an historical point of view, that allow us to see how this actors appear in the arena, when and under what motivations. The following moments can be briefly summarized for this exposition:

- **Decade of the '90s: the Full Disclosure movement. **
  A first moment in which the discovery of security bugs and the publication of attack strategies was carried out by the hacker community under a spirit of singularity, lateral thinking and creativity. The objective was to raise the security of the systems. The information was not monetized but made public through email lists such as Bugtraq, in order to obtain recognition among peers.
- **Late 1990s and early 2000s: the phenomena of buying Vulnerabilities**
  The purchase of vulnerabilities occurs as a new phenomenon. This period is monopolized by two actors who create a business model around the buying and selling of vulns and exploits. 
  **iDefense**: was created in 2002 and buys vulnerabilities from independent researchers and also has its own research laboratory. Under the business model of subscriptions it has its own clients to whom it exclusively informs security recommendations and mitigations against acquired vulnerabilities. 
  **Tipping point and its program Zero Day Initiative**: was created in 2005 and has a business model similar to iDefense. But with one difference Tipping Point develop an intrusion detection and prevention system (a program that monitors network traffic to control malicious access), so their customers exclusively get updated protection from temporary patches that protect against threats acquired by the company under the ZDI program.
- **Late 2000: Bounties bug vendors programs**
  A pioneer of these programs is Mozilla who offers money in exchange for bugs or security flaws. A trend towards crowd sourcing of security research is emerging. 
- **Decade of 2010: Bug Bounties Platforms**
  Intermediaries appear between the vendors and the security researchers. Their business model is to  charge for the review of the bug reports to ensure their quality to the vendor and also to provide a critical number of security researchers -through marketing strategies and incentives , a "multitude" willing to analyze the software of the vendor. In 2011 BugCrowd is born, in 2012 Hackerone, among others. At this point crowd sourcing "matures" in security research field. 

## Regulation 

### Budapest Convention
* Convention  signed in 2001.

**Problems:**
* Criminalizes research and development of security tools.  

* Signed by the following **countries of America**: Argentina, Canada, Chile, Colombia, Costa Rica, Panama, Paraguay, Peru, Dominican Republic, United States.

### Wassenaar Arrangement
* Multilateral Agreement on the Control of exports of Arms and Dual Technologies

**Problems:**
* In 2013, surveillance and intrusion systems were included in such a broad way that they included the great majority of technologies used in research and development at information security.

* In 2015, modifications were made to improve those changes made on 2013. Now there are not included technologies for vulnerability disclosure or cyber incident response. This remains limited nowadays.

## Final considerations  

### Vulnerable time window

During the entire trade process analyzed, most of the time the users remain vulnerable. The question is how to make vulnerability information available to the public so that they are safe in a faster way. A possible scenario would be to go through a coordinated disclosure, but what might happen if the vendor considers that it is not a priority for the business to give a solution to the reported bug? The user would remain vulnerable and ignorant of the vulnerability.  At the same time, if the path chosen is to make public the vulnerability, the question would be how much information it is necessary to provide? This strategy would be useful to -firts- put pressure on vendors to develop a patch and -second- might give enough information to system administrators and users to be able to patch themselves the security bug (without subscribing to private intermediates that charge a huge amount of money for that information).

In any case, it is important for organizations to have a bug bounties platform and to have a disclosure mechanism so that vulnerabilities can be reported, even if it is not with a monetary exchange (as for non-profit organizations) considering just a "wall of honour" model. A key question is to improve the patching mechanisms and give the importance it deserves to patches, not only considering the developers points of view but also at a user level, understanding the importance of keeping updated the systems and programs used.  

### Vulnerability/exploit commoditization process

We have seen that vulnerabilities/exploits have become exchange units with an assigned price, a demand and a buyer. Under the presence of markets that allow their buying and selling as an asset in exchange for money. In this scenario is important to identify that there is a private use of restricted information on vulnerabilities, with political and economic objectives. There is very little information (generally obtained by leaked data) on how actors such as Hacking Team and Gamma International are conducting their business. Certainly is urgent to gain accountability and public information regarding the behavior of all the actors involved in this ecosystem.   

### Security research

The offensive security / security research / vulnerability analysis is important for the detection of high-impact vulnerabilities, to raise the security of all of us. And that these activities are not criminalized without distinction. If there is going to be regulation on this matter, we consider that is crucial to avoid the criminalization of the investigation in security. Currently the analysis of vulnerabilities and investigations in offensive security are relevant issues that allow advancing the state of security of systems and vulnerable programs.

Finally, the crowd sourcing process has resulted in the advancement of labor flexibility in security research. Emphasis has been placed on externalizing and outsourcing security analyses and audits through intermediary platforms such as Hackerone, to the detriment of the constitution of internal security teams within organizations. We believe that both strategies are complementary and should be prioritized simultaneously to really achieve the detection of system failures.

## Notes

[1]:   Term adopted by Scott Culp, Microsoft Security Manager, in: "It's Time to End Information Anarchy". Technet Security. Microsoft TechNet. November 9, 2001.

## Bibliography

M. Marquis-Boire *et al.*, *For their eyes only: the commercialization of digital spying*. Toronto, Ont.: Citizen Lab, 2013.

D. McKinney, *Vulnerability Bazaar*. IEEE security & privacy., vol. 5, n.ยบ 6, pp. 69-73, 2007.

